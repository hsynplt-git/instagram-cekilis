<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Ã‡ekiliÅŸ Motoru</title>
<link rel="stylesheet" href="/static/style.css">
</head>

<body>
<div class="app">

  <div class="header">
    <img src="/static/logo.png">
    <h1>ğŸ‰ Instagram Ã‡ekiliÅŸ AracÄ±</h1>
    <p>Åeffaf â€¢ GÃ¼venilir â€¢ GerÃ§ek Verilerle</p>
  </div>

  <div class="tabs">
    <button class="tab active" onclick="showTab('draw')">ğŸ¯ Ã‡ekiliÅŸ BaÅŸlat</button>
    <button class="tab" onclick="showTab('search')">ğŸ” SonuÃ§ Sorgula</button>
  </div>

  <div id="draw" class="tab-content active">
    <input id="url" placeholder="Instagram post / reel linki">
    <button class="main" onclick="startDraw()">Ã‡ekiliÅŸi BaÅŸlat</button>

    <div id="drawResult"></div>
  </div>

  <div id="search" class="tab-content">
    <input id="drawid" placeholder="Ã‡ekiliÅŸ ID">
    <button class="main" onclick="searchDraw()">Sorgula</button>

    <div id="searchResult"></div>
  </div>

</div>

<script>
function showTab(id){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove("active"))
  document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove("active"))
  event.target.classList.add("active")
  document.getElementById(id).classList.add("active")
}

function startDraw(){
  fetch("/draw",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({url:document.getElementById("url").value})
  }).then(r=>r.json()).then(d=>{
    document.getElementById("drawResult").innerHTML = `
      <h3>Ã‡ekiliÅŸ ID: ${d.draw_id}</h3>
      <img src="${d.story}" class="story">
    `
  })
}

function searchDraw(){
  fetch("/result/"+document.getElementById("drawid").value)
  .then(r=>r.json()).then(d=>{
    document.getElementById("searchResult").innerHTML = `
      <h3>Kazananlar</h3>
      <p>${d.main.join(" , ")}</p>
      <h4>Yedekler</h4>
      <p>${d.backup.join(" , ")}</p>
      <img src="${d.story}" class="story">
    `
  })
}
</script>

</body>
</html>
