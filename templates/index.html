<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Instagram √áekili≈ü Motoru</title>
<style>
body{font-family:Arial;background:#f4f6fa;padding:20px}
.tab{display:inline-block;padding:10px 20px;cursor:pointer;background:#ddd;margin-right:10px}
.tab.active{background:#fff;font-weight:bold}
.box{background:#fff;padding:20px;border-radius:10px;display:none}
.box.active{display:block}
.user{display:flex;align-items:center;margin:10px 0}
.user img{width:50px;height:50px;border-radius:50%;margin-right:10px}
</style>
</head>

<body>

<img src="/static/logo.png" width="180">

<div>
  <div class="tab active" onclick="show(1)">üéÅ √áekili≈ü Ba≈ülat</div>
  <div class="tab" onclick="show(2)">üîç √áekili≈ü Sorgula</div>
</div>

<div id="tab1" class="box active">
<input id="url" placeholder="Instagram Post URL" style="width:60%">
<button onclick="start()">√áekili≈üi Ba≈ülat</button>
<div id="result"></div>
</div>

<div id="tab2" class="box">
<input id="did" placeholder="√áekili≈ü ID">
<button onclick="search()">Sorgula</button>
<div id="query"></div>
</div>

<script>
function show(i){
 document.querySelectorAll(".box").forEach(x=>x.classList.remove("active"))
 document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"))
 document.getElementById("tab"+i).classList.add("active")
 document.querySelectorAll(".tab")[i-1].classList.add("active")
}

function start(){
 fetch("/draw",{
   method:"POST",
   headers:{"Content-Type":"application/json"},
   body:JSON.stringify({url:document.getElementById("url").value})
 }).then(r=>r.json()).then(d=>{
   let html=`<h3>√áekili≈ü ID: ${d.id}</h3><h4>Kazananlar</h4>`
   d.winners.forEach(u=>{
     html+=`<div class="user"><img src="${u.avatar}">@${u.username}</div>`
   })
   html+="<h4>Yedekler</h4>"
   d.backups.forEach(u=>{
     html+=`<div class="user"><img src="${u.avatar}">@${u.username}</div>`
   })
   document.getElementById("result").innerHTML=html
 })
}

function search(){
 fetch("/result/"+document.getElementById("did").value)
 .then(r=>r.json()).then(d=>{
   let html="<h3>Kazananlar</h3>"
   d.winners.forEach(u=>{
     html+=`<div class="user"><img src="${u.avatar}">@${u.username}</div>`
   })
   document.getElementById("query").innerHTML=html
 })
}
</script>

</body>
</html>
